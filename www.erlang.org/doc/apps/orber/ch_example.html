<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Orber Examples</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../../../doc/js/erlresolvelinks.js"></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="../../erlang-logo.png"><br><small>
<a href="users_guide.html">User's Guide</a><br>
<a href="index.html">Reference Manual</a><br>
<a href="release_notes.html">Release Notes</a><br>
<a href="orber.pdf">PDF</a><br>
<a href="../../index.html">Top</a></small><p><strong>orber</strong><br><strong>User's Guide</strong><br><small>Version 3.6.14</small></p>
<br>
<a href="javascript:openAllFlips()">Expand All</a><br>
<a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Chapters</strong></small></p>
<ul class="flipMenu" imagepath="../../../../doc/js/flipmenu">
<li title="The Orber Application" expanded="false">The Orber Application<ul>
<li>
<a href="ch_contents.html">
              Top of chapter
            </a></li>
<li title="Content Overview">
<a href="ch_contents.html#id2259402">Content Overview</a></li>
<li title="Brief Description of the User's Guide">
<a href="ch_contents.html#id2259376">Brief Description of the User's Guide</a></li>
</ul>
</li>
<li title="Introduction to Orber" expanded="false">Introduction to Orber<ul>
<li>
<a href="ch_introduction.html">
              Top of chapter
            </a></li>
<li title="Overview">
<a href="ch_introduction.html#id2252427">Overview</a></li>
</ul>
</li>
<li title="The Orber Application" expanded="false">The Orber Application<ul>
<li>
<a href="ch_orber_kernel.html">
              Top of chapter
            </a></li>
<li title="ORB Kernel and IIOP ">
<a href="ch_orber_kernel.html#id2261015">ORB Kernel and IIOP </a></li>
<li title="The Object Request Broker (ORB)">
<a href="ch_orber_kernel.html#id2251828">The Object Request Broker (ORB)</a></li>
<li title="Internet Inter-Object Protocol (IIOP)">
<a href="ch_orber_kernel.html#id2267302">Internet Inter-Object Protocol (IIOP)</a></li>
</ul>
</li>
<li title="Interface Repository" expanded="false">Interface Repository<ul>
<li>
<a href="ch_ifr.html">
              Top of chapter
            </a></li>
<li title="Interface Repository(IFR)">
<a href="ch_ifr.html#id2267338">Interface Repository(IFR)</a></li>
</ul>
</li>
<li title="Installing Orber" expanded="false">Installing Orber<ul>
<li>
<a href="ch_install.html">
              Top of chapter
            </a></li>
<li title="Installation Process ">
<a href="ch_install.html#id2272824">Installation Process </a></li>
<li title="Configuration">
<a href="ch_install.html#id2256610">Configuration</a></li>
<li title="Firewall Configuration">
<a href="ch_install.html#id2274291">Firewall Configuration</a></li>
<li title="Interface Configuration">
<a href="ch_install.html#id2274782">Interface Configuration</a></li>
</ul>
</li>
<li title="OMG IDL to Erlang Mapping" expanded="false">OMG IDL to Erlang Mapping<ul>
<li>
<a href="ch_idl_to_erlang_mapping.html">
              Top of chapter
            </a></li>
<li title="OMG IDL to Erlang Mapping - Overview">
<a href="ch_idl_to_erlang_mapping.html#id2275032">OMG IDL to Erlang Mapping - Overview</a></li>
<li title="OMG IDL Mapping Elements">
<a href="ch_idl_to_erlang_mapping.html#id2275062">OMG IDL Mapping Elements</a></li>
<li title="Getting Started">
<a href="ch_idl_to_erlang_mapping.html#id2275125">Getting Started</a></li>
<li title="Basic OMG IDL Types">
<a href="ch_idl_to_erlang_mapping.html#id2275198">Basic OMG IDL Types</a></li>
<li title="Template OMG IDL Types and Complex Declarators">
<a href="ch_idl_to_erlang_mapping.html#id2275748">Template OMG IDL Types and Complex Declarators</a></li>
<li title="Constructed OMG IDL Types">
<a href="ch_idl_to_erlang_mapping.html#id2276275">Constructed OMG IDL Types</a></li>
<li title="Scoped Names and Generated Files">
<a href="ch_idl_to_erlang_mapping.html#id2276721">Scoped Names and Generated Files</a></li>
<li title="Typecode, Identity and Name Access Functions">
<a href="ch_idl_to_erlang_mapping.html#id2277155">Typecode, Identity and Name Access Functions</a></li>
<li title="References to Constants">
<a href="ch_idl_to_erlang_mapping.html#id2277312">References to Constants</a></li>
<li title="References to Objects Defined in OMG IDL">
<a href="ch_idl_to_erlang_mapping.html#id2277377">References to Objects Defined in OMG IDL</a></li>
<li title="Exceptions">
<a href="ch_idl_to_erlang_mapping.html#id2277402">Exceptions</a></li>
<li title="Access to Attributes">
<a href="ch_idl_to_erlang_mapping.html#id2277440">Access to Attributes</a></li>
<li title="Invocations of Operations">
<a href="ch_idl_to_erlang_mapping.html#id2277502">Invocations of Operations</a></li>
<li title="Implementing the DB Application">
<a href="ch_idl_to_erlang_mapping.html#id2277683">Implementing the DB Application</a></li>
<li title="Reserved Compiler Names and Keywords">
<a href="ch_idl_to_erlang_mapping.html#id2277971">Reserved Compiler Names and Keywords</a></li>
<li title="Type Code Representation">
<a href="ch_idl_to_erlang_mapping.html#id2278732">Type Code Representation</a></li>
</ul>
</li>
<li title="CosNaming Service" expanded="false">CosNaming Service<ul>
<li>
<a href="ch_naming_service.html">
              Top of chapter
            </a></li>
<li title="Overview of the CosNaming Service">
<a href="ch_naming_service.html#id2279411">Overview of the CosNaming Service</a></li>
<li title="The Basic Use-cases of the Naming Service">
<a href="ch_naming_service.html#id2279576">The Basic Use-cases of the Naming Service</a></li>
<li title="Interoperable Naming Service">
<a href="ch_naming_service.html#id2279955">Interoperable Naming Service</a></li>
</ul>
</li>
<li title="How to use security in Orber" expanded="false">How to use security in Orber<ul>
<li>
<a href="ch_security.html">
              Top of chapter
            </a></li>
<li title="Security in Orber">
<a href="ch_security.html#id2280869">Security in Orber</a></li>
</ul>
</li>
<li title="Orber Examples" expanded="true">Orber Examples<ul>
<li>
<a href="ch_example.html">
              Top of chapter
            </a></li>
<li title="A Tutorial on How to Create a Simple Service">
<a href="ch_example.html#id2281287">A Tutorial on How to Create a Simple Service</a></li>
</ul>
</li>
<li title="Orber Stubs/Skeletons" expanded="false">Orber Stubs/Skeletons<ul>
<li>
<a href="ch_stubs.html">
              Top of chapter
            </a></li>
<li title="Orber Stubs and Skeletons Description">
<a href="ch_stubs.html#id2281642">Orber Stubs and Skeletons Description</a></li>
</ul>
</li>
<li title="CORBA System and User Defined Exceptions" expanded="false">CORBA System and User Defined Exceptions<ul>
<li>
<a href="ch_exceptions.html">
              Top of chapter
            </a></li>
<li title="System Exceptions">
<a href="ch_exceptions.html#id2282304">System Exceptions</a></li>
<li title="User Defined Exceptions">
<a href="ch_exceptions.html#id2282788">User Defined Exceptions</a></li>
<li title="Throwing Exceptions">
<a href="ch_exceptions.html#id2282812">Throwing Exceptions</a></li>
<li title="Catching Exceptions">
<a href="ch_exceptions.html#id2282848">Catching Exceptions</a></li>
</ul>
</li>
<li title="Orber Interceptors" expanded="false">Orber Interceptors<ul>
<li>
<a href="ch_interceptors.html">
              Top of chapter
            </a></li>
<li title="Using Interceptors">
<a href="ch_interceptors.html#id2282969">Using Interceptors</a></li>
<li title="Interceptor Example">
<a href="ch_interceptors.html#id2283211">Interceptor Example</a></li>
</ul>
</li>
<li title="OrberWeb" expanded="false">OrberWeb<ul>
<li>
<a href="ch_orberweb.html">
              Top of chapter
            </a></li>
<li title="Using OrberWeb">
<a href="ch_orberweb.html#id2283528">Using OrberWeb</a></li>
<li title="Starting OrberWeb">
<a href="ch_orberweb.html#id2284178">Starting OrberWeb</a></li>
</ul>
</li>
<li title="Debugging" expanded="false">Debugging<ul>
<li>
<a href="ch_debugging.html">
              Top of chapter
            </a></li>
<li title="Tools and FAQ">
<a href="ch_debugging.html#id2284274">Tools and FAQ</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>9 Orber Examples</h1>
  
  <h3><a name="id2281287">9.1 
        A Tutorial on How to Create a Simple Service</a></h3>
    
    <h4>Interface Design</h4>
      
      <p>This example uses a very simple stack server. The specification
        contains two interfaces: the first is the Stack itself and the 
        other is the StackFactory which is used to create new stacks. 
        The specification is in the file <span class="code">stack.idl</span>.</p>
      
    
    <h4>Generating Erlang Code</h4>
      
      <p>Run the IDL compiler on this file by calling the <span class="code">ic:gen/1</span> function      </p>
      <div class="example"><pre>
\0111&gt; ic:gen("stack").
      </pre></div>
      <p>This will produce the client stub and server skeleton. Among other files a stack API module named <span class="code">StackModule_Stack.erl</span>
        will be produced.
        This will produce among other files a stack API module called 
        <span class="code">StackModule_Stack.erl</span> which contains the client stub and
        the server skeleton. </p>
    
    <h4>Implementation of Interface</h4>
      
      <p>After generating the API stubs and the server skeletons it is time to 
        implement the servers and if no special options are sent 
        to the IDL compiler the file name should be
        <span class="code">&lt;global interface name&gt;_impl.erl</span>, in our case
        <span class="code">StackModule_Stack_impl.erl</span>.</p>
      
      <p>We also have the factory interface which is used to create new stacks
        and that implementation is in the file 
        <span class="code">StackModule_StackFactory_impl.erl</span>.</p>
      
      <p>To start the factory server one executes the function 
        <span class="code">StackModule_StackFactory:oe_create/0</span> which in this 
        example is done in the module <span class="code">stack_factory.erl</span> where 
        the started service is also registered in the name service.</p>
      
    
    <h4>Writing a Client in Erlang</h4>
      
      <p>At last we will write a client to access our service.</p>
      
    
    <h4>Writing a Client in Java</h4>
      
      <p>To write a Java client for Orber you must have another
        ORB that uses IIOP for client-server communication and supports a
        Java language mapping. It must also have support for
        <span class="code">IDL:CosNaming/NamingContext</span> or <span class="code">IDL:CosNaming/NamingContextExt</span>.
        If the client ORB support Interoperable Naming Service the Java Client
        can look like:</p>
      
      <div class="note">
<div class="label">Note</div>
<div class="content"><p>
        <p>If an ORB does not support CosNaming at all the <span class="code">cos_naming.idl</span> 
          file must be compiled and imported.</p>
      </p></div>
</div>
    
    <h4>Building the Example</h4>
      
      <p>To build the example for access from a Java client you need a Java 
        enabled ORB (e.g. JavaIDL). The example below is based on JDK-1.4.</p>
      <div class="example"><pre>
fingolfin 127&gt; erl            
Erlang (BEAM) emulator version 5.5.4.3 [async-threads:0] [hipe] [kernel-poll:false]
Eshell V5.5.4.3  (abort with ^G)
1&gt; ic:gen(stack).
Erlang IDL compiler version 4.2.12
ok
2&gt; make:all().
Recompile: StackModule_EmptyStack
Recompile: StackModule_Stack
Recompile: StackModule_StackFactory
Recompile: StackModule_StackFactory_impl
Recompile: StackModule_Stack_impl
Recompile: oe_stack
Recompile: stack_client
Recompile: stack_factory
up_to_date
3&gt; 
BREAK: (a)bort (c)ontinue (p)roc info (i)nfo (l)oaded
       (v)ersion (k)ill (D)b-tables (d)istribution
a
fingolfin 128&gt; idlj stack.idl
fingolfin 129&gt; javac StackModule/*.java
fingolfin 130&gt; javac *.java
fingolfin 131&gt; cp StackClient.class StackModule/
      </pre></div>
    
    <h4>How to Run Everything</h4>
      
      <p>Below is a short transcript on how to run Orber.</p>
      <div class="example"><pre>
fingolfin 143&gt; erl 
Erlang (BEAM) emulator version 5.5.4.3 [async-threads:0] [hipe] [kernel-poll:false]
Eshell V5.5.4.3  (abort with ^G)
1&gt; orber:jump_start([{interceptors, {native, [orber_iiop_tracer_silent]}}]).
ok
2&gt; oe_stack:oe_register().     
ok
3&gt; stack_factory:start().
ok
4&gt; stack_client:run().
1
1
7
4
ok
5&gt; 
      </pre></div>
      <p>Before testing the Java part of this example generate and compile Java classes for 
        <span class="code">orber/examples/stack.idl</span> as seen in the build example. 
        To run the Java client use the following command:</p>
      <div class="example"><pre>
fingolfin 38&gt; java StackModule.StackClient "corbaname::localhost:4001#StackFactory"
1
1
7
4
Empty stack
fingolfin 39&gt; 
      </pre></div>
    
  
</div>
<div class="footer">
<hr>
<p>Copyright © 1997-2009 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-3045895-1";
urchinTracker();
</script> 
</body>
</html>
