<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Using Common Test for Large Scale Testing</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../../../doc/js/erlresolvelinks.js"></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="../../erlang-logo.png"><br><small>
<a href="users_guide.html">User's Guide</a><br>
<a href="index.html">Reference Manual</a><br>
<a href="release_notes.html">Release Notes</a><br>
<a href="common_test.pdf">PDF</a><br>
<a href="../../index.html">Top</a></small><p><strong>Common Test</strong><br><strong>User's Guide</strong><br><small>Version 1.4.6</small></p>
<br>
<a href="javascript:openAllFlips()">Expand All</a><br>
<a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Chapters</strong></small></p>
<ul class="flipMenu" imagepath="../../../../doc/js/flipmenu">
<li title="Common Test Basics" expanded="false">Common Test Basics<ul>
<li>
<a href="basics_chapter.html">
              Top of chapter
            </a></li>
<li title="Introduction">
<a href="basics_chapter.html#id2259966">Introduction</a></li>
<li title="Test Suite Organisation">
<a href="basics_chapter.html#id2253168">Test Suite Organisation</a></li>
<li title="Support Libraries">
<a href="basics_chapter.html#id2252019">Support Libraries</a></li>
<li title="Suites and Test Cases">
<a href="basics_chapter.html#id2252025">Suites and Test Cases</a></li>
<li title="External Interfaces">
<a href="basics_chapter.html#id2253081">External Interfaces</a></li>
</ul>
</li>
<li title="Installation" expanded="false">Installation<ul>
<li>
<a href="install_chapter.html">
              Top of chapter
            </a></li>
<li title="General information">
<a href="install_chapter.html#id2260114">General information</a></li>
<li title="Unix/Linux">
<a href="install_chapter.html#id2253924">Unix/Linux</a></li>
<li title="Windows">
<a href="install_chapter.html#id2257012">Windows</a></li>
</ul>
</li>
<li title="Writing Test Suites" expanded="false">Writing Test Suites<ul>
<li>
<a href="write_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Support for test suite authors">
<a href="write_test_chapter.html#id2260181">Support for test suite authors</a></li>
<li title="Test suites">
<a href="write_test_chapter.html#id2260124">Test suites</a></li>
<li title="Init and end per suite">
<a href="write_test_chapter.html#id2259307">Init and end per suite</a></li>
<li title="Init and end per test case">
<a href="write_test_chapter.html#id2253645">Init and end per test case</a></li>
<li title="Test cases">
<a href="write_test_chapter.html#id2262666">Test cases</a></li>
<li title="Test case info function">
<a href="write_test_chapter.html#id2258139">Test case info function</a></li>
<li title="Test suite info function">
<a href="write_test_chapter.html#id2263742">Test suite info function</a></li>
<li title="Test case groups">
<a href="write_test_chapter.html#id2263834">Test case groups</a></li>
<li title="The parallel property and nested groups">
<a href="write_test_chapter.html#id2264105">The parallel property and nested groups</a></li>
<li title="Repeated groups">
<a href="write_test_chapter.html#id2264149">Repeated groups</a></li>
<li title="Shuffled test case order">
<a href="write_test_chapter.html#id2264310">Shuffled test case order</a></li>
<li title="Data and Private Directories">
<a href="write_test_chapter.html#id2264379">Data and Private Directories</a></li>
<li title="Execution environment">
<a href="write_test_chapter.html#id2264458">Execution environment</a></li>
<li title="Illegal dependencies">
<a href="write_test_chapter.html#id2264508">Illegal dependencies</a></li>
</ul>
</li>
<li title="Test Structure" expanded="false">Test Structure<ul>
<li>
<a href="test_structure_chapter.html">
              Top of chapter
            </a></li>
<li title="Test structure">
<a href="test_structure_chapter.html#id2264726">Test structure</a></li>
<li title="Skipping test cases">
<a href="test_structure_chapter.html#id2264743">Skipping test cases</a></li>
<li title="Definition of terms">
<a href="test_structure_chapter.html#id2264827">Definition of terms</a></li>
</ul>
</li>
<li title="Examples and Templates" expanded="false">Examples and Templates<ul>
<li>
<a href="example_chapter.html">
              Top of chapter
            </a></li>
<li title="Test suite example">
<a href="example_chapter.html#id2265696">Test suite example</a></li>
<li title="Test suite templates">
<a href="example_chapter.html#id2265783">Test suite templates</a></li>
</ul>
</li>
<li title="Running Test Suites" expanded="false">Running Test Suites<ul>
<li>
<a href="run_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Using the Common Test Framework">
<a href="run_test_chapter.html#id2266081">Using the Common Test Framework</a></li>
<li title="Automatic compilation of test suites and help modules">
<a href="run_test_chapter.html#id2266125">Automatic compilation of test suites and help modules</a></li>
<li title="Running tests from the UNIX command line">
<a href="run_test_chapter.html#id2266259">Running tests from the UNIX command line</a></li>
<li title="Running tests from the Web based GUI">
<a href="run_test_chapter.html#id2266575">Running tests from the Web based GUI</a></li>
<li title="Running tests from the Erlang shell or from an Erlang program">
<a href="run_test_chapter.html#id2266661">Running tests from the Erlang shell or from an Erlang program</a></li>
<li title="Running the interactive shell mode">
<a href="run_test_chapter.html#id2266717">Running the interactive shell mode</a></li>
<li title="Step by step execution of test cases with the Erlang Debugger">
<a href="run_test_chapter.html#id2266894">Step by step execution of test cases with the Erlang Debugger</a></li>
<li title="Using test specifications">
<a href="run_test_chapter.html#id2266995">Using test specifications</a></li>
<li title="Log files">
<a href="run_test_chapter.html#id2267233">Log files</a></li>
<li title="HTML Style Sheets">
<a href="run_test_chapter.html#id2267439">HTML Style Sheets</a></li>
<li title="Repeating tests">
<a href="run_test_chapter.html#id2267626">Repeating tests</a></li>
<li title="Silent Connections">
<a href="run_test_chapter.html#id2267872">Silent Connections</a></li>
</ul>
</li>
<li title="Config Files" expanded="false">Config Files<ul>
<li>
<a href="config_file_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="config_file_chapter.html#id2268112">General</a></li>
<li title="Syntax">
<a href="config_file_chapter.html#id2268151">Syntax</a></li>
<li title="Requiring and reading configuration data">
<a href="config_file_chapter.html#id2268175">Requiring and reading configuration data</a></li>
<li title="Using configuration variables defined in multiple files">
<a href="config_file_chapter.html#id2268325">Using configuration variables defined in multiple files</a></li>
<li title="Encrypted configuration files">
<a href="config_file_chapter.html#id2268357">Encrypted configuration files</a></li>
<li title="Opening connections by using configuration data">
<a href="config_file_chapter.html#id2268422">Opening connections by using configuration data</a></li>
<li title="Examples">
<a href="config_file_chapter.html#id2268496">Examples</a></li>
</ul>
</li>
<li title="Code Coverage Analysis" expanded="false">Code Coverage Analysis<ul>
<li>
<a href="cover_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="cover_chapter.html#id2268615">General</a></li>
<li title="Usage">
<a href="cover_chapter.html#id2268641">Usage</a></li>
<li title="The cover specification file">
<a href="cover_chapter.html#id2268768">The cover specification file</a></li>
<li title="Logging">
<a href="cover_chapter.html#id2268835">Logging</a></li>
</ul>
</li>
<li title="Using Common Test for Large Scale Testing" expanded="true">Using Common Test for Large Scale Testing<ul>
<li>
<a href="ct_master_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="ct_master_chapter.html#id2268911">General</a></li>
<li title="Usage">
<a href="ct_master_chapter.html#id2268954">Usage</a></li>
<li title="Test Specifications">
<a href="ct_master_chapter.html#id2269112">Test Specifications</a></li>
</ul>
</li>
<li title="Event Handling" expanded="false">Event Handling<ul>
<li>
<a href="event_handler_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="event_handler_chapter.html#id2269384">General</a></li>
<li title="Usage">
<a href="event_handler_chapter.html#id2269429">Usage</a></li>
</ul>
</li>
<li title="Dependencies between Test Cases and Suites" expanded="false">Dependencies between Test Cases and Suites<ul>
<li>
<a href="dependencies_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="dependencies_chapter.html#id2270363">General</a></li>
<li title="Saving configuration data">
<a href="dependencies_chapter.html#id2270526">Saving configuration data</a></li>
<li title="Sequences">
<a href="dependencies_chapter.html#id2270719">Sequences</a></li>
</ul>
</li>
<li title="Some thoughts about testing" expanded="false">Some thoughts about testing<ul>
<li>
<a href="why_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Goals">
<a href="why_test_chapter.html#id2270931">Goals</a></li>
<li title="What to test?">
<a href="why_test_chapter.html#id2270956">What to test?</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>9 Using Common Test for Large Scale Testing</h1>
  
  <h3><a name="id2268911">9.1 
        General</a></h3>
    
    <p>Large scale automated testing requires running multiple independent 
      test sessions in parallel. This is accomplished by running
      a number of Common Test nodes on one or more hosts, testing
      different target systems. Configuring, starting and controlling the
      test nodes independently can be a cumbersome operation. To aid
      this kind of automated large scale testing, CT offers a master test 
      node component, CT Master, that handles central configuration and control
      in a system of distributed CT nodes.</p>
    <p>The CT Master server runs on one dedicated Erlang node and uses distributed
      Erlang to communicate with any number of CT test nodes, each hosting a regular
      CT server. Test specifications are used as input to specify what to test on which 
      test nodes, using what configuration.</p> 
    <p>The CT Master server writes progress information to HTML log files similarly 
      to the regular CT server. The logs contain test statistics and links to the 
      log files written by each independent CT server.</p>
    <p>The CT master API is exported by the <span class="code">ct_master</span> module.</p>
  
  <h3><a name="id2268954">9.2 
        Usage</a></h3>
    
    <p>CT Master requires all test nodes to be on the same network and share a common 
      file system. As of this date, CT Master can not start test nodes
      automatically. The nodes must have been started in advance for CT Master to be 
      able to start test sessions on them.</p>
      
    <p>Tests are started by calling:</p>
    
    <p><span class="code">ct_master:run(TestSpecs)</span> or 
       <span class="code">ct_master:run(TestSpecs, InclNodes, ExclNodes)</span></p>
    
    <p><span class="code">TestSpecs</span> is either the name of a test specification file (string) or a list 
      of test specifications. In case of a list, the specifications will be handled (and
      the corresponding tests executed) in sequence. An element in a <span class="code">TestSpecs</span> list 
      can also be list of test specifications. The specifications in such a list will be 
      merged into one combined specification prior to test execution. For example:</p>
      
    <p><span class="code">ct_master:run(["ts1","ts2",["ts3","ts4"]])</span></p>
    <p>means first the tests specified by "ts1" will run, then the tests specified by "ts2" 
      and finally the tests specified by both "ts3" and "ts4".</p>
    <p>The <span class="code">InclNodes</span> argument to <span class="code">run/3</span> is a list of node names. The <span class="code">run/3</span> 
      function runs the tests in <span class="code">TestSpecs</span> just like <span class="code">run/1</span> but will also 
      take any test in <span class="code">TestSpecs</span> that's not explicitly tagged with a particular 
      node name and execute it on the nodes listed in <span class="code">InclNodes</span>. By using <span class="code">run/3</span> 
      this way it is possible to use any test specification, with or without node information, 
      in a large scale test environment! <span class="code">ExclNodes</span> is a list of nodes that should be
      excluded from the test. I.e. tests that have been specified in the test specification 
      to run on a particular node will not be performed if that node is at runtime
      listed in <span class="code">ExclNodes</span>.</p>
      <p>If CT Master fails initially to connect to any of the test nodes specified in a 
      test specification or in the <span class="code">InclNodes</span> list, the operator will be prompted with 
      the option to either start over again (after manually checking the status of the 
      node(s) in question), to run without the missing nodes, or to abort the operation.</p>
      <p>When tests start, CT Master prints information to console about the nodes that are 
      involved. CT Master also reports when tests finish, successfully or unsuccessfully. If
      connection is lost to a node, the test on that node is considered finished. CT Master 
      will not attempt to reestablish contact with the failing node. At any time to get the
      current status of the test nodes, call the function:</p>
      <p><span class="code">ct_master:progress()</span></p>
      <p>To stop one or more tests, use:</p>
      <p><span class="code">ct_master:abort()</span> (stop all) or <span class="code">ct_master:abort(Nodes)</span></p>
      <p>For detailed information about the <span class="code">ct_master</span> API, please see the 
      manual page for this module.</p>
  
  <h3><a name="id2269112">9.3 
        Test Specifications</a></h3>
    
    <p>The test specifications used as input to CT Master are fully compatible with the
    specifications used as input to the regular CT server. The syntax is described in the 
    <span class="bold_code">
<a href="run_test_chapter.html#test_specifications">Running Test Suites</a></span>
    chapter.</p>
    <p>All test specification terms can have a <span class="code">NodeRefs</span> element. This element
    specifies which node or nodes a configuration operation or a test is to be executed 
    on. <span class="code">NodeRefs</span> is defined as:</p>
    
    <p><span class="code">NodeRefs = all_nodes | [NodeRef] | NodeRef</span></p>
    
    <p>where</p>
    <p><span class="code">NodeRef = NodeAlias | node() | master</span></p>
    <p>A <span class="code">NodeAlias</span> (<span class="code">atom()</span>) is used in a test specification as a 
    reference to a node name (so the actual node name only needs to be declared once). 
    The alias is declared with a <span class="code">node</span> term:</p>
    <p><span class="code">{node, NodeAlias, NodeName}</span></p>
    <p>If <span class="code">NodeRefs</span> has the value <span class="code">all_nodes</span>, the operation or test will
    be performed on all given test nodes. (Declaring a term without a <span class="code">NodeRefs</span> 
    element actually has the same effect). If <span class="code">NodeRefs</span> has the value 
    <span class="code">master</span>, the operation is only performed on the CT Master node (namely set 
    the log directory or install an event handler).</p>
    <p>Consider the example in the 
    <span class="bold_code">
<a href="run_test_chapter.html#test_specifications">Running Test Suites</a></span>
    chapter, now extended with node information and intended to be executed by the
    CT Master:</p>
    <div class="example"><pre>
      {node, node1, ct_node@host_x}.
      {node, node2, ct_node@host_y}.
 
      {logdir, master, "/home/test/master_logs"}.
      {logdir, "/home/test/logs"}.
      
      {config, node1, "/home/test/t1/cfg/config.cfg"}.
      {config, node2, "/home/test/t2/cfg/config.cfg"}.
      {config, "/home/test/t3/cfg/config.cfg"}.
      
      {alias, t1, "/home/test/t1"}.
      {alias, t2, "/home/test/t2"}.
      {alias, t3, "/home/test/t3"}.
      
      {suites, node1, t1, all}.
      {skip_suites, node1, t1, [t1B_SUITE,t1D_SUITE], "Not implemented"}.
      {skip_cases, node1, t1, t1A_SUITE, [test3,test4], "Irrelevant"}.
      {skip_cases, node1, t1, t1C_SUITE, [test1], "Ignore"}.
      
      {suites, node2, t2, [t2B_SUITE,t2C_SUITE]}.
      {cases, node2, t2, t2A_SUITE, [test4,test1,test7]}.
      
      {skip_suites, t3, all, "Not implemented"}.
    </pre></div>
    <p>This example specifies the same tests as the original example. But 
    now if started with a call to <span class="code">ct_master:run(TestSpecName)</span>, the 
    t1 test will be executed on node <span class="code">ct_node@host_x</span> (node1), the
    t2 test on <span class="code">ct_node@host_y</span> (node2) and the t3 test on both
    node1 and node2. The t1 config file will only be read on
    node1 and the t2 config file only on node2, while the t3 config file
    will be read on both node1 and node2. Both test nodes will write log 
    files to the same directory. (The CT Master node will however use a 
    different log directory than the test nodes).</p>
    <p>If the test session is instead started with a call to 
    <span class="code">ct_master:run(TestSpecName, [ct_node@host_z], [ct_node@host_x])</span>, 
    the result is that the t1 test does not run on 
    <span class="code">ct_node@host_x</span> (or any other node) while the t3 test runs on
    <span class="code">ct_node@host_y</span> and <span class="code">ct_node@host_z</span>.</p>
    
    <p>A nice feature is that a test specification that includes node 
      information can still be used as input to the regular Common Test server 
      (as described in the
    <span class="bold_code">
<a href="run_test_chapter.html#test_specifications">Running Test Suites</a></span>
    chapter). The result is that any test specified to run on a node with the same
    name as the Common Test node in question (typically <span class="code">ct@somehost</span> if started
    with the <span class="code">run_test</span> script), will be performed. Tests without explicit
    node association will always be performed too of course!</p>
    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>It is recommended that absolute paths are used for log directories,
    config files and test directory aliases in the test specifications so that
    current working directory settings are not important.</p></p></div>
</div>
  
</div>
<div class="footer">
<hr>
<p>Copyright © 2003-2009 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-3045895-1";
urchinTracker();
</script> 
</body>
</html>
