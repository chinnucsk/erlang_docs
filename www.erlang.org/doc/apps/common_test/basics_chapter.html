<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Common Test Basics</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../../../doc/js/erlresolvelinks.js"></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="../../erlang-logo.png"><br><small>
<a href="users_guide.html">User's Guide</a><br>
<a href="index.html">Reference Manual</a><br>
<a href="release_notes.html">Release Notes</a><br>
<a href="common_test.pdf">PDF</a><br>
<a href="../../index.html">Top</a></small><p><strong>Common Test</strong><br><strong>User's Guide</strong><br><small>Version 1.4.6</small></p>
<br>
<a href="javascript:openAllFlips()">Expand All</a><br>
<a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Chapters</strong></small></p>
<ul class="flipMenu" imagepath="../../../../doc/js/flipmenu">
<li title="Common Test Basics" expanded="true">Common Test Basics<ul>
<li>
<a href="basics_chapter.html">
              Top of chapter
            </a></li>
<li title="Introduction">
<a href="basics_chapter.html#id2259966">Introduction</a></li>
<li title="Test Suite Organisation">
<a href="basics_chapter.html#id2253168">Test Suite Organisation</a></li>
<li title="Support Libraries">
<a href="basics_chapter.html#id2252019">Support Libraries</a></li>
<li title="Suites and Test Cases">
<a href="basics_chapter.html#id2252025">Suites and Test Cases</a></li>
<li title="External Interfaces">
<a href="basics_chapter.html#id2253081">External Interfaces</a></li>
</ul>
</li>
<li title="Installation" expanded="false">Installation<ul>
<li>
<a href="install_chapter.html">
              Top of chapter
            </a></li>
<li title="General information">
<a href="install_chapter.html#id2260114">General information</a></li>
<li title="Unix/Linux">
<a href="install_chapter.html#id2253924">Unix/Linux</a></li>
<li title="Windows">
<a href="install_chapter.html#id2257012">Windows</a></li>
</ul>
</li>
<li title="Writing Test Suites" expanded="false">Writing Test Suites<ul>
<li>
<a href="write_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Support for test suite authors">
<a href="write_test_chapter.html#id2260181">Support for test suite authors</a></li>
<li title="Test suites">
<a href="write_test_chapter.html#id2260124">Test suites</a></li>
<li title="Init and end per suite">
<a href="write_test_chapter.html#id2259307">Init and end per suite</a></li>
<li title="Init and end per test case">
<a href="write_test_chapter.html#id2253645">Init and end per test case</a></li>
<li title="Test cases">
<a href="write_test_chapter.html#id2262666">Test cases</a></li>
<li title="Test case info function">
<a href="write_test_chapter.html#id2258139">Test case info function</a></li>
<li title="Test suite info function">
<a href="write_test_chapter.html#id2263742">Test suite info function</a></li>
<li title="Test case groups">
<a href="write_test_chapter.html#id2263834">Test case groups</a></li>
<li title="The parallel property and nested groups">
<a href="write_test_chapter.html#id2264105">The parallel property and nested groups</a></li>
<li title="Repeated groups">
<a href="write_test_chapter.html#id2264149">Repeated groups</a></li>
<li title="Shuffled test case order">
<a href="write_test_chapter.html#id2264310">Shuffled test case order</a></li>
<li title="Data and Private Directories">
<a href="write_test_chapter.html#id2264379">Data and Private Directories</a></li>
<li title="Execution environment">
<a href="write_test_chapter.html#id2264458">Execution environment</a></li>
<li title="Illegal dependencies">
<a href="write_test_chapter.html#id2264508">Illegal dependencies</a></li>
</ul>
</li>
<li title="Test Structure" expanded="false">Test Structure<ul>
<li>
<a href="test_structure_chapter.html">
              Top of chapter
            </a></li>
<li title="Test structure">
<a href="test_structure_chapter.html#id2264726">Test structure</a></li>
<li title="Skipping test cases">
<a href="test_structure_chapter.html#id2264743">Skipping test cases</a></li>
<li title="Definition of terms">
<a href="test_structure_chapter.html#id2264827">Definition of terms</a></li>
</ul>
</li>
<li title="Examples and Templates" expanded="false">Examples and Templates<ul>
<li>
<a href="example_chapter.html">
              Top of chapter
            </a></li>
<li title="Test suite example">
<a href="example_chapter.html#id2265696">Test suite example</a></li>
<li title="Test suite templates">
<a href="example_chapter.html#id2265783">Test suite templates</a></li>
</ul>
</li>
<li title="Running Test Suites" expanded="false">Running Test Suites<ul>
<li>
<a href="run_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Using the Common Test Framework">
<a href="run_test_chapter.html#id2266081">Using the Common Test Framework</a></li>
<li title="Automatic compilation of test suites and help modules">
<a href="run_test_chapter.html#id2266125">Automatic compilation of test suites and help modules</a></li>
<li title="Running tests from the UNIX command line">
<a href="run_test_chapter.html#id2266259">Running tests from the UNIX command line</a></li>
<li title="Running tests from the Web based GUI">
<a href="run_test_chapter.html#id2266575">Running tests from the Web based GUI</a></li>
<li title="Running tests from the Erlang shell or from an Erlang program">
<a href="run_test_chapter.html#id2266661">Running tests from the Erlang shell or from an Erlang program</a></li>
<li title="Running the interactive shell mode">
<a href="run_test_chapter.html#id2266717">Running the interactive shell mode</a></li>
<li title="Step by step execution of test cases with the Erlang Debugger">
<a href="run_test_chapter.html#id2266894">Step by step execution of test cases with the Erlang Debugger</a></li>
<li title="Using test specifications">
<a href="run_test_chapter.html#id2266995">Using test specifications</a></li>
<li title="Log files">
<a href="run_test_chapter.html#id2267233">Log files</a></li>
<li title="HTML Style Sheets">
<a href="run_test_chapter.html#id2267439">HTML Style Sheets</a></li>
<li title="Repeating tests">
<a href="run_test_chapter.html#id2267626">Repeating tests</a></li>
<li title="Silent Connections">
<a href="run_test_chapter.html#id2267872">Silent Connections</a></li>
</ul>
</li>
<li title="Config Files" expanded="false">Config Files<ul>
<li>
<a href="config_file_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="config_file_chapter.html#id2268112">General</a></li>
<li title="Syntax">
<a href="config_file_chapter.html#id2268151">Syntax</a></li>
<li title="Requiring and reading configuration data">
<a href="config_file_chapter.html#id2268175">Requiring and reading configuration data</a></li>
<li title="Using configuration variables defined in multiple files">
<a href="config_file_chapter.html#id2268325">Using configuration variables defined in multiple files</a></li>
<li title="Encrypted configuration files">
<a href="config_file_chapter.html#id2268357">Encrypted configuration files</a></li>
<li title="Opening connections by using configuration data">
<a href="config_file_chapter.html#id2268422">Opening connections by using configuration data</a></li>
<li title="Examples">
<a href="config_file_chapter.html#id2268496">Examples</a></li>
</ul>
</li>
<li title="Code Coverage Analysis" expanded="false">Code Coverage Analysis<ul>
<li>
<a href="cover_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="cover_chapter.html#id2268615">General</a></li>
<li title="Usage">
<a href="cover_chapter.html#id2268641">Usage</a></li>
<li title="The cover specification file">
<a href="cover_chapter.html#id2268768">The cover specification file</a></li>
<li title="Logging">
<a href="cover_chapter.html#id2268835">Logging</a></li>
</ul>
</li>
<li title="Using Common Test for Large Scale Testing" expanded="false">Using Common Test for Large Scale Testing<ul>
<li>
<a href="ct_master_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="ct_master_chapter.html#id2268911">General</a></li>
<li title="Usage">
<a href="ct_master_chapter.html#id2268954">Usage</a></li>
<li title="Test Specifications">
<a href="ct_master_chapter.html#id2269112">Test Specifications</a></li>
</ul>
</li>
<li title="Event Handling" expanded="false">Event Handling<ul>
<li>
<a href="event_handler_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="event_handler_chapter.html#id2269384">General</a></li>
<li title="Usage">
<a href="event_handler_chapter.html#id2269429">Usage</a></li>
</ul>
</li>
<li title="Dependencies between Test Cases and Suites" expanded="false">Dependencies between Test Cases and Suites<ul>
<li>
<a href="dependencies_chapter.html">
              Top of chapter
            </a></li>
<li title="General">
<a href="dependencies_chapter.html#id2270363">General</a></li>
<li title="Saving configuration data">
<a href="dependencies_chapter.html#id2270526">Saving configuration data</a></li>
<li title="Sequences">
<a href="dependencies_chapter.html#id2270719">Sequences</a></li>
</ul>
</li>
<li title="Some thoughts about testing" expanded="false">Some thoughts about testing<ul>
<li>
<a href="why_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Goals">
<a href="why_test_chapter.html#id2270931">Goals</a></li>
<li title="What to test?">
<a href="why_test_chapter.html#id2270956">What to test?</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>1 Common Test Basics</h1>
  
  <h3><a name="id2259966">1.1 
        Introduction</a></h3>
    
    <p>
      The Common Test framework (CT) is a tool which can support
      implementation and automated execution of test cases towards different
      types of target systems. The framework is based on the OTP Test
      Server. Test cases can be run individually or in batches. Common
      Test also features a distributed testing mode with central
      control and logging. This feature makes it possible to test
      multiple systems independently in one common session. This
      can be very useful e.g. for running automated large-scale regression 
      tests.
    </p>
    <p>
      The SUT (System Under Test) may consist of one or several target
      nodes.  CT contains a generic test server which together with
      other test utilities is used to perform test case execution. 
      It is possible to start the tests from the CT GUI or from an OS- or
      Erlang shell prompt. <strong>Test suites</strong> are files (Erlang
      modules) that contain the <strong>test cases</strong> (Erlang functions)
      to be executed. <strong>Support modules</strong> provide functions
      that the test cases utilize in order to carry out the tests.
    </p>
    
    <p>
      The main idea is that CT based test programs connect to
      the target system(s) via standard O&amp;M interfaces. CT
      provides implementations and wrappers of some of these O&amp;M
      interfaces and will be extended with more interfaces later. 
      There are a number of target independent interfaces
      supported in CT such as Generic Telnet, FTP etc. which can be
      specialized or used directly for controlling instruments, 
      traffic generators etc.</p> 
    
    <p>Common Test is also a very useful tool for white-box testing Erlang
      code since the test programs can call Erlang API functions directly. 
      For black-box testing Erlang software, Erlang RPC as well as 
      standard O&amp;M interfaces can be used.
    </p>
    
    <p>A test case can handle several connections towards one or
      several target systems, instruments and traffic generators in
      parallel in order to perform the necessary actions for a
      test. The handling of many connections in parallel is one of
      the major strengths of Common Test!      
    </p>
  
  <h3><a name="id2253168">1.2 
        Test Suite Organisation</a></h3>
    
    <p>
      The test suites are organized in test directories and each test suite
      may have a separate data directory. Typically, these files and directories
      are version controlled similarly to other forms of source code (possibly by
      means of a version control system like GIT or Subversion). However, CT does 
      not itself put any requirements on (or has any form of awareness of) 
      possible file and directory versions.
    </p>
  
  <h3><a name="id2252019">1.3 
        Support Libraries</a></h3>
    
    <p>
      Support libraries contain functions that are useful for all test suites,
      or for test suites in a specific functional area or subsystem.
      In addition to the general support libraries provided by the
      CT framework, and the various libraries and applications provided by
      Erlang/OTP, there might also be a need for customized (user specific) 
      support libraries. 
    </p>
  
  <h3><a name="id2252025">1.4 
        Suites and Test Cases</a></h3>
    
    <p>
      Testing is performed by running test suites (sets of test cases) or 
      individual test cases. A test suite is implemented as an Erlang module named 
      <span class="code">&lt;suite_name&gt;_SUITE.erl</span> which contains a number of test cases.
      A test case is an Erlang function which tests one or more things. 
      The test case is the smallest unit that the CT test server deals with.
    </p>
    <p>
      Subsets of test cases, called test case groups, may also be defined. A test case 
      group can have execution properties associated with it. Execution properties 
      specify whether the test cases in the group should be executed in
      random order, in parallel, in sequence, and if the execution of the group 
      should be repeated. Test case groups may also be nested (i.e. a group may,
      besides test cases, contain sub-groups).
    </p>
    <p>
      Besides test cases and groups, the test suite may also contain configuration 
      functions. These functions are meant to be used for setting up (and verifying)
      environment and state on the SUT (and/or the CT host node), required for 
      the tests to execute correctly. Examples of operations: Opening a connection
      to the SUT, initializing a database, running an installation script, etc.
      Configuration may be performed per suite, per test case group and per 
      individual test case.
    </p>
    <p>
      The test suite module must conform to a callback interface specified 
      by the CT test server. See the 
      <span class="bold_code">
<a href="write_test_chapter.html#intro">Writing Test Suites</a></span> chapter
      for more information.
    </p>
    <p>
      A test case is considered successful if it returns to the caller, no matter 
      what the returned value is. A few return values have special meaning however
      (such as <span class="code">{skip,Reason}</span> which indicates that the test case is skipped,
      <span class="code">{comment,Comment}</span> which prints a comment in the log for the test case and 
      <span class="code">{save_config,Config}</span> which makes the CT test server pass <span class="code">Config</span> to 
      the next test case). 
      A test case failure is specified as a runtime error (a crash), no matter what 
      the reason for termination is. If you use Erlang pattern matching effectively,
      you can take advantage of this property. The result will be concise and 
      readable test case functions that look much more like scripts than actual programs. 
      Simple example:
    </p>
    <div class="example"><pre>
      session(_Config) -&gt;
          {started,ServerId} = my_server:start(),
          {clients,[]} = my_server:get_clients(ServerId),
          MyId = self(),
          connected = my_server:connect(ServerId, MyId),
          {clients,[MyId]} = my_server:get_clients(ServerId),
          disconnected = my_server:disconnect(ServerId, MyId),
          {clients,[]} = my_server:get_clients(ServerId),
          stopped = my_server:stop(ServerId).
    </pre></div>
    <p>
      As a test suite runs, all information (including output to <span class="code">stdout</span>) is 
      recorded in several different log files. A minimum of information is displayed 
      in the user console (only start and stop information, plus a note 
      for each failed test case).
    </p>
    <p>
      The result from each test case is recorded in a dedicated HTML log file, created 
      for the particular test run. An overview page displays each test case represented 
      by row in a table showing total execution time, whether the case was successful,
      failed or skipped, plus an optional user comment. (For a failed test case, the 
      reason for termination is also printed in the comment field). The overview page
      has a link to each test case log file, providing simple navigation with any standard
      HTML browser.
    </p>
    
  <h3><a name="id2253081">1.5 
        External Interfaces</a></h3>
    
    <p>
      The CT test server requires that the test suite defines and exports the 
      following mandatory or optional callback functions:
    </p>
    
    <dl>
      <dt><strong>all()</strong></dt>
        <dd>Returns a list of all test cases in the suite. (Mandatory)</dd>
      <dt><strong>suite()</strong></dt>
        <dd>Info function used to return properties for the suite. (Optional)</dd>
      <dt><strong>groups()</strong></dt>
        <dd>For declaring test case groups. (Optional)</dd>
      <dt><strong>init_per_suite(Config)</strong></dt>
        <dd>Suite level configuration function, executed before the first 
	test case. (Optional)</dd>
      <dt><strong>end_per_suite(Config)</strong></dt>
        <dd>Suite level configuration function, executed after the last 
	test case. (Optional)</dd>
      <dt><strong>init_per_group(GroupName, Config)</strong></dt>
        <dd>Configuration function for a group, executed before the first 
	test case. (Mandatory if groups are defined)</dd>
      <dt><strong>end_per_group(GroupName, Config)</strong></dt>
        <dd>Configuration function for a group, executed after the last 
	test case. (Mandatory if groups are defined)</dd>
      <dt><strong>init_per_testcase(TestCase, Config)</strong></dt>
        <dd>Configuration function for a testcase, executed before each 
	test case. (Optional)</dd>
      <dt><strong>end_per_testcase(TestCase, Config)</strong></dt>
      <dd>Configuration function for a testcase, executed after each 
      test case. (Optional)</dd> 
    </dl>
      <p>
	For each test case the CT test server expects these functions:
      </p>
      <dl>
	<dt><strong>Testcasename()</strong></dt>
	  <dd>Info function that returns a list of test case properties. (Optional)</dd>
	<dt><strong>Testcasename(Config)</strong></dt> 
	  <dd>The actual test case function.</dd> 
      </dl>
    
</div>
<div class="footer">
<hr>
<p>Copyright © 2003-2009 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-3045895-1";
urchinTracker();
</script> 
</body>
</html>
